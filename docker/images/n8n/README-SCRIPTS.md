# n8n Docker Setup Scripts

This directory contains scripts to easily set up and manage n8n with PostgreSQL using Docker Compose.

## ğŸ“ Files

- `setup-n8n.sh` - Complete setup script for first-time installation
- `n8n-control.sh` - Control script for managing running services
- `docker-compose.yml` - Docker Compose configuration
- `.env` - Environment variables (auto-generated if missing)

## ğŸš€ Quick Start

### First Time Setup

```bash
# Run the complete setup script
./setup-n8n.sh
```

This script will:
- âœ… Check Docker and Docker Compose availability
- âœ… Create necessary directories
- âœ… Set proper permissions
- âœ… Create/update `.env` file with encryption key
- âœ… Pull latest Docker images
- âœ… Start n8n and PostgreSQL services
- âœ… Verify services are running

### Daily Usage

```bash
# Start services
./n8n-control.sh start

# Stop services
./n8n-control.sh stop

# Restart services
./n8n-control.sh restart

# Check status
./n8n-control.sh status

# View logs
./n8n-control.sh logs

# Follow logs in real-time
./n8n-control.sh logs -f

# Update to latest version
./n8n-control.sh update
```

## ğŸŒ Access URLs

- **Local**: http://localhost:5678
- **Domain**: https://n8n.securityphoenix.com

## ğŸ“ Data Locations

- **n8n data**: `./data/`
- **PostgreSQL data**: `./postgres-data/`

## ğŸ”§ Configuration

The `.env` file contains all configuration. Key settings:

```bash
# Database
POSTGRES_DB=n8n
POSTGRES_USER=n8n
POSTGRES_PASSWORD=Phoenix1100

# n8n
N8N_ENCRYPTION_KEY=<auto-generated>
N8N_HOST=0.0.0.0
N8N_PORT=5678

# Domain
DOMAIN_NAME=securityphoenix.com
N8N_HOST=n8n.securityphoenix.com
```

## ğŸ› ï¸ Troubleshooting

### Services won't start
```bash
# Check logs
./n8n-control.sh logs

# Restart services
./n8n-control.sh restart
```

### Permission issues
```bash
# Clean up and restart
./n8n-control.sh clean
./setup-n8n.sh
```

### Update n8n
```bash
# Pull latest version
./n8n-control.sh update
```

## ğŸ“‹ Manual Commands

If you prefer to run commands manually:

```bash
# Start services
docker compose up -d

# Stop services
docker compose down

# View logs
docker compose logs -f

# Check status
docker compose ps

# Update images
docker compose pull && docker compose up -d
```

## ğŸ”’ Security Notes

- The encryption key is auto-generated and stored in `.env`
- Database credentials are in `.env` - change default password
- Data is stored in host directories, not Docker volumes
- Services run on localhost:5678 by default

## ğŸ“ Support

If you encounter issues:
1. Check logs: `./n8n-control.sh logs`
2. Restart services: `./n8n-control.sh restart`
3. Clean and reinstall: `./n8n-control.sh clean && ./setup-n8n.sh` 